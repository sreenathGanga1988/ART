@model ArtWebApp.Areas.CuttingMVC.ViewModel.ATCwiseFabricConsume
@using System.Data;

<script>

    $(document).ready(function () {
        $('.MyDataTable thead tr.filterrow th').each(function () {
            var title = $('.MyDataTable thead th').eq($(this).index()).text().trim();
            $(this).html('<input type="text" onclick="stopPropagation(event);" placeholder="Search ' + title + '" />');
        });
        $(".MyDataTable thead input").on('keyup change', function () {
            table
                .column($(this).parent().index() + ':visible')
                .search(this.value)
                .draw();
        });
        var table = $('.MyDataTable').DataTable({
            "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
            orderCellsTop: true,
            dom: 'Blfrtip',
            buttons: [
                'copy', 'csv', 'excel', 'pdf', 'print', 'colvis', { extend: 'excelHtml5', footer: true },
            ],
            "footerCallback": function (row, data, start, end, display) {
                var api = this.api(), data;

                // Remove the formatting to get integer data for summation
                var intVal = function (i) {
                    return typeof i === 'string' ?
                        i.replace(/[\$,]/g, '') * 1 :
                        typeof i === 'number' ?
                            i : 0;
                };

                // Total over all pages
                total = api
                    .column(3)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Total over this page
                pageTotal = api
                    .column(3, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Update footer
                $(api.column(3).footer()).html(
                    pageTotal
                );

                // Total over all pages
                total = api
                    .column(4)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Total over this page
                pageTotal = api
                    .column(4, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Update footer
                $(api.column(4).footer()).html(
                    pageTotal
                );
                // Total over all pages
                total = api
                    .column(5)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Total over this page
                pageTotal = api
                    .column(5, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Update footer
                $(api.column(5).footer()).html(
                    pageTotal
                );

                // Total over all pages
                total = api
                    .column(6)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Total over this page
                pageTotal = api
                    .column(6, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Update footer
                $(api.column(6).footer()).html(
                    pageTotal
                );

                // Total over all pages
                total = api
                    .column(11)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Total over this page
                pageTotal = api
                    .column(11, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Update footer
                $(api.column(11).footer()).html(
                    pageTotal
                );

                // Total over all pages
                total = api
                    .column(12)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Total over this page
                pageTotal = api
                    .column(12, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                // Update footer
                $(api.column(12).footer()).html(
                    pageTotal
                );



            }
        });

        function stopPropagation(evt) {
            if (evt.stopPropagation !== undefined) {
                evt.stopPropagation();
            } else {
                evt.cancelBubble = true;
            }
        }
    });

</script>



<div id="printfcr">
    <table id="MyDataTable" class="MyDataTable table table-striped table-bordered" cellspacing="0" width="100" style="border-color:black">
        <thead>

            <tr style="border-color:black">

                <th>Ourstyle</th>
                <th>Location</th>
                <th>Color</th>
                <th>OrderQty(ASQ)</th>
                <th>CutQty</th>
                <th>BalQty</th>
                <th>Fabric Consumed</th>
                <th>LaysheetDate</th>
                <th>Consumption/PC</th>
                <th>ApprovedCons/PC</th>
                <th>BOMConsumption/PC</th>
                <th>BOM Consumed</th>
                <th>AgainstBOMSaving</th>
                @*@foreach (DataColumn col in Model.GetATCwisefabricconsume.Columns)
                        {
                            <th class="@col.ColumnName" style="border-color:black">
                                @col.ColumnName
                            </th>
                }*@

            </tr>



        </thead>

        <tbody>
            @foreach (DataRow row in Model.GetATCwisefabricconsume.Rows)
        {
            <tr style="border-color:black">
                <td>@row["OurStyle"]</td>
                <td>@row["LocationName"]</td>
                <td>@row["color"]</td>
                <td>@row["OrderQty(ASQ)"]</td>
                <td>@row["CutQty"]</td>
                <td>@row["BalCutQty"]</td>
                <td>@row["FabricConsumed"]</td>
                <td>@row["laysheetdate"]</td>
                <td>@row["ConsumptionPerPC"]</td>
                <td>@row["ApprovedConsPPC"]</td>
                <td>@row["BOMConsumptionPerPc"]</td>
                <td>@row["BOMConsumed"]</td>
                <td>@row["AgainstBOMSaving"]</td>

                @*@foreach (DataColumn col in Model.GetATCwisefabricconsume.Columns)
                {
                    <td class="@col.ColumnName" style="border-color:black">
                        @row[@col.ColumnName]

                    </td>
                }*@
            </tr>

    }
        </tbody>
        <tfoot>
            <tr>
                <th colspan="3" style="text-align:right">Total:</th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
        </tfoot>
    </table>

</div>




